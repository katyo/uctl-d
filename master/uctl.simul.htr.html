<!DOCTYPE html>
<html lang="en">
<head>
        <title>uctl.simul.htr (uctl.simul.htr)</title>
	<meta charset="utf-8" />
	<meta content="width=device-width, initial-scale=1" name="viewport" />
        <link href="style.css" rel="stylesheet" />
        <script src="script.js" type="text/javascript"></script>

	
	<link href="search-results.html" rel="prefetch" />
<link href="katex.min.css" rel="stylesheet" /></head>
<body>
	<div id="page-header">
		<div id="logotype">
		<span>uctl documentation</span>
		<nav>
			<a href="http://github.com/katyo/uctl-d">uctl-d</a>
		</nav>
		</div>

		<form action="search-docs.html" id="search">
			<input name="searchTerm" placeholder="Find a symbol name..." type="search" />
			<input type="submit" value="Go" />
		</form>
	</div>
	<div id="page-body">
		<div id="page-content">
		<h1>uctl.simul.htr</h1><div class="breadcrumbs"><a class="breadcrumb" href="uctl.html">uctl</a> <a class="breadcrumb" href="uctl.simul.html">simul</a> </div><div><div class="documentation-comment synopsis"><div><h2 class="user-header" id="heater-model"><a class="header-anchor" href="#heater-model">Heater model</a></h2><p>Simple heater model for realtime simulation.</p><p>Model input:</p><ul class="user-list"><li><span class="raw-tex-math">P</span> - applied heater power, <i>W</i></li></ul><p>Model output:</p><ul class="user-list"><li><span class="raw-tex-math">\dot{T}</span> - current heating block temperature, <i>&#176;</i></li></ul><p>Model parameters:</p><ul class="user-list"><li><span class="raw-tex-math">R</span> - thermal resistance between heater and ambient, <i>&#176;/W</i></li><li><span class="raw-tex-math">C</span> - thermal capacity of heating block, <i>J/&#176;</i> or <i>Kg/m<sup>2</sup>S<sup>-2</sup>&#176;</i></li><li><span class="raw-tex-math">m</span> - mass of heating block, <i>Kg</i></li><li><span class="raw-tex-math">T_a</span> - ambient temperature, <i>&#176;</i></li><li><span class="raw-tex-math">dt</span> - simulation step period, <i>S</i></li></ul><p>Model state:</p><ul class="user-list"><li><span class="raw-tex-math">T</span> - previous heating block temperature, <i>&#176;</i></li></ul><p>Model definition:</p><p><span class="raw-tex-math">P = P_a + P_d</span> (1)</p><p>where:</p><ul class="user-list"><li><span class="raw-tex-math">P</span> - total power, <i>W</i></li><li><span class="raw-tex-math">P_a</span> - accumulating power, <i>W</i></li><li><span class="raw-tex-math">P_d</span> - diffusing power, <i>W</i></li></ul><p><span class="raw-tex-math">P_a = C m \frac{\dot{T} - T}{dt}</span> (2)</p><p><span class="raw-tex-math">P_d = \frac{T - T_a}{R}</span> (3)</p><p><span class="raw-tex-math">P = C m \frac{\dot{T} - T}{dt} + \frac{T - T_a}{R}</span></p><p><span class="raw-tex-math">\dot{T} = \frac{C m R \times T + (T_a + P R) \times dt}{C m R + dt}</span></p><p><span class="raw-tex-math">\dot{T} = \frac{T_a dt}{dt + C m R} + T \frac{CmR}{dt + C m R} + P \frac{R dt}{dt + C m R}</span> (4)</p><p>Let
   <span class="raw-tex-math">a = \frac{T_a dt}{dt + C m R}</span>
   <span class="raw-tex-math">b = \frac{C m R}{dt + C m R}</span>
   <span class="raw-tex-math">c = \frac{R dt}{dt + C m R}</span></p><p>So <span class="raw-tex-math">\dot{T} = a + T \times b + P \times c</span> (5)</p><p>Check for initial off-state conditions when <span class="raw-tex-math">P = 0</span> and <span class="raw-tex-math">T = T_a</span>:</p><p><span class="raw-tex-math">\dot{T} = T_a \frac{dt}{dt + C m R} + T_a \frac{ C m R}{dt + C m R}</span></p><p><span class="raw-tex-math">\dot{T} = T_a \frac{dt + C m R}{dt + C m R}</span></p><p><span class="raw-tex-math">\dot{T} = T_a</span></p><p>Check for off-state condition when <span class="raw-tex-math">P = 0</span>:</p><p><span class="raw-tex-math">\dot{T} = T_a \frac{dt}{dt + C m R} + T \frac{C m R}{dt + C m R}</span></p><p>Let <span class="raw-tex-math">T = T_a + T_d</span></p><p>where <span class="raw-tex-math">T_d</span> - temperature delta for single simulation step.</p><p><span class="raw-tex-math">\dot{T} = T_a \frac{dt}{dt + C m R} + T_a \frac{C m R}{dt + C m R} + T_d \frac{C m R}{dt + C m R}</span></p><p><span class="raw-tex-math">\dot{T} = T_a + T_d \frac{C m R}{dt + C m R}</span></p><p>Because <span class="raw-tex-math">\frac{C m R}{dt + C m R} &lt; 1</span>
   so <span class="raw-tex-math">T_d \frac{C m R}{dt + C m R} \rightarrow 0</span>
   and then <span class="raw-tex-math">\dot{T} \rightarrow T_a</span></p><p><img alt="Hotend simulation example" src="sim_htr.svg" /></p></div></div></div><div class="annotated-prototype"></div><h2 id="members"><a class="header-anchor" href="#members">Members</a></h2><h3 class="member-list-header hide-from-toc" id="function"><a class="header-anchor" href="#function">Functions</a></h3><dl class="member-list native"><dt><a href="uctl.simul.htr.mk.1.html">mk</a><div class="simplified-prototype" style="max-width: 28ch;"><span class="lang-feature">auto</span>  <span class="name">mk</span>(C C_, M m_, R R_)</div></dt><dd><div><p>Create heater parameters</p></div></dd><dt><a href="uctl.simul.htr.mk.2.html">mk</a><div class="simplified-prototype" style="max-width: 15ch;"><span class="lang-feature">auto</span>  <span class="name">mk</span>(T t0)</div></dt><dd><div><p>Create header state</p></div></dd></dl><h3 class="member-list-header hide-from-toc" id="struct"><a class="header-anchor" href="#struct">Structs</a></h3><dl class="member-list native"><dt><a href="uctl.simul.htr.Param.html">Param</a><div class="simplified-prototype" style="max-width: 37ch;"><span class="builtin-type">struct</span> <span class="name">Param</span><span class="template-params">(alias s_, C_, M_, R_)</span></div></dt><dd><div><p>Heater parameters</p></div></dd><dt><a href="uctl.simul.htr.State.html">State</a><div class="simplified-prototype" style="max-width: 28ch;"><span class="builtin-type">struct</span> <span class="name">State</span><span class="template-params">(alias P_, T_)</span></div></dt><dd><div><p>Heater model state</p></div></dd></dl><h2 id="mixed-in-members"><a class="header-anchor" href="#mixed-in-members">Mixed In Members</a></h2><h3 id="from-mixin-unittests-">From <tt class="highlighted"><span class="kwrd">mixin</span> <span class="hid">unittests</span> </tt></h3><dl class="member-list native"></dl><div></div></div>
		<div id="page-nav"><a class="parent" href="uctl.html">uctl</a> <a class="parent" href="uctl.simul.html">simul</a> 
		<span class="type-separator">modules</span><ul><li><a class="module" href="uctl.simul.dcm.html">dcm</a></li><li><a class="module current" href="uctl.simul.htr.html">htr</a></li><li><a class="module" href="uctl.simul.thr.html">thr</a></li></ul></div>
	</div>
	<div id="page-footer">Page generated by <a href="https://github.com/adamdruppe/adrdox">adrdox</a></div>
<script onload="document.querySelectorAll('span.raw-tex-math').forEach(function(e){e.outerHTML=katex.renderToString(e.innerText)})" src="katex.min.js" type="text/javascript"></script></body>
</html>